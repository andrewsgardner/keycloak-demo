CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

CREATE TABLE IF NOT EXISTS users (
  id uuid DEFAULT uuid_generate_v4(), 
  username VARCHAR NOT NULL,
  first_name VARCHAR NOT NULL,
  last_name VARCHAR NOT NULL,
  PRIMARY KEY (username)
);

INSERT INTO users (username, first_name, last_name) VALUES ('rsmith', 'Rachel', 'Smith'), ('jpatel', 'Jason', 'Patel'), ('fwatkins', 'Frank', 'Watkins');

CREATE TABLE IF NOT EXISTS projects (
    id INT GENERATED BY DEFAULT AS IDENTITY,
    project_id TEXT GENERATED ALWAYS AS ('PRJ-' || id::text) STORED,
    project_name VARCHAR(255) NOT NULL,
    created_by VARCHAR REFERENCES users(username),
    create_date TIMESTAMP DEFAULT current_timestamp,
    modified_by VARCHAR REFERENCES users(username),
    modified_date TIMESTAMP DEFAULT current_timestamp,
    PRIMARY KEY (id)
);

INSERT INTO projects (project_name, created_by, modified_by) VALUES ('Hello World App', 'rsmith', 'rsmith');